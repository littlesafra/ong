#leer fichero
library("readxl")
data <- read_excel("/Users/Elena/Desktop/proba.xls")
#Escalar datos(valor neutro)
data.scale <- scale(data[,2:6])
set.seed(80)
data.km <- kmeans(data.scale,centers = 4)
#contenido del objeto
names(data.km)
#asignaciones del cluster
data.km$cluster
#añadimos clusters a la tabla
data$Cluster <- data.km$cluster
#filtramos por grupos
library(dplyr)
grupo1 <- filter(data, data$Cluster == 1)
grupo2 <- filter(data, data$Cluster == 2)
grupo3 <- filter(data, data$Cluster == 3)
grupo4 <- filter(data, data$Cluster == 4)
#creamos una tabla por grupo, con las medias correspondientes
Poblacion1 <- sum(grupo1$Poblacion)
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
Poblacion_total <- sum(data$Poblacion)
#Grupo1
Nombre <- "Grupo1"
Renta_Personal, Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Nombre, Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo2
#Nombre <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbind(Poblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#Grupo3
#Nombre <- "Grupo3"
Poblacion3 <- sum(grupo3$Poblacion)
Renta_Personal <- mean(grupo3$Renta_Personal)
Renta_Familiar <- mean(grupo3$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo3.medias <- data.frame(cbind(Poblacion3, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo3.medias$porcentajePoblacion <- Poblacion3 * 100 / Poblacion_total
#Grupo4
#Nombre <- "Grupo4"
Poblacion4 <- sum(grupo4$Poblacion)
Renta_Personal <- mean(grupo4$Renta_Personal)
Renta_Familiar <- mean(grupo4$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo4.medias <- data.frame(cbind(Poblacion4, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo4.medias$porcentajePoblacion <- Poblacion4 * 100 / Poblacion_total
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
#Mostramos un gráfico XY con la población por
plot(medias.total$Renta_Mixta,medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
#leer fichero
library("readxl")
data <- read_excel("/Users/Elena/Desktop/proba.xls")
#Escalar datos(valor neutro)
data.scale <- scale(data[,2:6])
set.seed(80)
data.km <- kmeans(data.scale,centers = 4)
#contenido del objeto
names(data.km)
#asignaciones del cluster
data.km$cluster
#añadimos clusters a la tabla
data$Cluster <- data.km$cluster
#filtramos por grupos
library(dplyr)
grupo1 <- filter(data, data$Cluster == 1)
grupo2 <- filter(data, data$Cluster == 2)
grupo3 <- filter(data, data$Cluster == 3)
grupo4 <- filter(data, data$Cluster == 4)
#creamos una tabla por grupo, con las medias correspondientes
Poblacion1 <- sum(grupo1$Poblacion)
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
Poblacion_total <- sum(data$Poblacion)
#Grupo1
Nombre <- "Grupo1"
Renta_Personal, Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Nombre, Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo2
#Nombre <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbind(Poblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#filtramos por grupos
library(dplyr)
grupo1 <- filter(data, data$Cluster == 1)
grupo2 <- filter(data, data$Cluster == 2)
grupo3 <- filter(data, data$Cluster == 3)
grupo4 <- filter(data, data$Cluster == 4)
#creamos una tabla por grupo, con las medias correspondientes
Poblacion1 <- sum(grupo1$Poblacion)
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
Poblacion_total <- sum(data$Poblacion)
#Grupo1
Nombre <- "Grupo1"
Renta_Personal, Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo2
#Nombre <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbind(Poblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#Grupo3
#Nombre <- "Grupo3"
Poblacion3 <- sum(grupo3$Poblacion)
Renta_Personal <- mean(grupo3$Renta_Personal)
Renta_Familiar <- mean(grupo3$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo3.medias <- data.frame(cbind(Poblacion3, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo3.medias$porcentajePoblacion <- Poblacion3 * 100 / Poblacion_total
#Grupo4
#Nombre <- "Grupo4"
Poblacion4 <- sum(grupo4$Poblacion)
Renta_Personal <- mean(grupo4$Renta_Personal)
Renta_Familiar <- mean(grupo4$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo4.medias <- data.frame(cbind(Poblacion4, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo4.medias$porcentajePoblacion <- Poblacion4 * 100 / Poblacion_total
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
#Mostramos un gráfico XY con la población por
plot(medias.total$Renta_Mixta,medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
#Grupo1
Nombre1 <- "Grupo1"
Renta_Personal, Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Nombre1, Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo2
Nombre2 <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbind(Nombre2, Poblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#Grupo3
Nombre3 <- "Grupo3"
Poblacion3 <- sum(grupo3$Poblacion)
Renta_Personal <- mean(grupo3$Renta_Personal)
Renta_Familiar <- mean(grupo3$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo3.medias <- data.frame(cbind(Nombre3, Poblacion3, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo3.medias$porcentajePoblacion <- Poblacion3 * 100 / Poblacion_total
#Grupo4
Nombre4 <- "Grupo4"
Poblacion4 <- sum(grupo4$Poblacion)
Renta_Personal <- mean(grupo4$Renta_Personal)
Renta_Familiar <- mean(grupo4$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo4.medias <- data.frame(cbind(Nombre4, Poblacion4, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo4.medias$porcentajePoblacion <- Poblacion4 * 100 / Poblacion_total
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
#Mostramos un gráfico XY con la población por
plot(medias.total$Renta_Mixta,medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
View(medias.total)
plot(medias.total$Renta_Mixta, medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
plot(medias.total$Renta_Mixta, medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
#Grupo1
Nombre1 <- "Grupo1"
Renta_Personal, Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo2
Nombre2 <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbindPoblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#Grupo3
Nombre3 <- "Grupo3"
Poblacion3 <- sum(grupo3$Poblacion)
Renta_Personal <- mean(grupo3$Renta_Personal)
Renta_Familiar <- mean(grupo3$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo3.medias <- data.frame(cbind(Poblacion3, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo3.medias$porcentajePoblacion <- Poblacion3 * 100 / Poblacion_total
#Grupo4
Nombre4 <- "Grupo4"
Poblacion4 <- sum(grupo4$Poblacion)
Renta_Personal <- mean(grupo4$Renta_Personal)
Renta_Familiar <- mean(grupo4$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo4.medias <- data.frame(cbind(Poblacion4, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo4.medias$porcentajePoblacion <- Poblacion4 * 100 / Poblacion_total
#TablaMediasGrupos
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
#borrar variables de entorno
remove(list = ls())
#leer fichero
library("readxl")
data <- read_excel("/Users/Elena/Desktop/proba.xls")
#Escalar datos(valor neutro)
data.scale <- scale(data[,2:6])
set.seed(80)
data.km <- kmeans(data.scale,centers = 4)
#contenido del objeto
names(data.km)
#asignaciones del cluster
data.km$cluster
#añadimos clusters a la tabla
data$Cluster <- data.km$cluster
#filtramos por grupos
library(dplyr)
grupo1 <- filter(data, data$Cluster == 1)
grupo2 <- filter(data, data$Cluster == 2)
grupo3 <- filter(data, data$Cluster == 3)
grupo4 <- filter(data, data$Cluster == 4)
#creamos una tabla por grupo, con las medias correspondientes
Poblacion1 <- sum(grupo1$Poblacion)
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
Poblacion_total <- sum(data$Poblacion)
#Grupo1
Nombre1 <- "Grupo1"
Renta_Personal, Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo1
Nombre1 <- "Grupo1"
Renta_Personal <- Renta_Familiar, Renta_Mixta))
Renta_Personal <- mean(grupo1$Renta_Personal)
Renta_Familiar <- mean(grupo1$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo1.medias <- data.frame(cbind(Poblacion1, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo1.medias$porcentajePoblacion <- Poblacion1 * 100 / Poblacion_total
#Grupo2
Nombre2 <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbindPoblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#Grupo3
Nombre3 <- "Grupo3"
Poblacion3 <- sum(grupo3$Poblacion)
Renta_Personal <- mean(grupo3$Renta_Personal)
Renta_Familiar <- mean(grupo3$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo3.medias <- data.frame(cbind(Poblacion3, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo3.medias$porcentajePoblacion <- Poblacion3 * 100 / Poblacion_total
#Grupo4
Nombre4 <- "Grupo4"
Poblacion4 <- sum(grupo4$Poblacion)
Renta_Personal <- mean(grupo4$Renta_Personal)
Renta_Familiar <- mean(grupo4$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo4.medias <- data.frame(cbind(Poblacion4, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo4.medias$porcentajePoblacion <- Poblacion4 * 100 / Poblacion_total
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
#Mostramos un gráfico XY con la población por
plot(medias.total$Renta_Mixta, medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
#Mostramos un gráfico XY con la población por
plot(medias.total$Renta_Mixta, medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
Nombre2 <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbindPoblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#Grupo2
Nombre2 <- "Grupo2"
Poblacion2 <- sum(grupo2$Poblacion)
Renta_Personal <- mean(grupo2$Renta_Personal)
Renta_Familiar <- mean(grupo2$Renta_Familiar)
Renta_Mixta <- (Renta_Personal/Renta_Familiar * 100)
grupo2.medias <- data.frame(cbind(Poblacion2, Renta_Personal, Renta_Familiar, Renta_Mixta))
grupo2.medias$porcentajePoblacion <- Poblacion2 * 100 / Poblacion_total
#TablaMediasGrupos
medias.total <- data.frame(rbind(as.matrix(grupo1.medias), as.matrix(grupo2.medias),as.matrix(grupo3.medias),as.matrix(grupo4.medias)))
#Mostramos un gráfico XY con la población por
plot(medias.total$Renta_Mixta, medias.total$Poblacion1, main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
View(medias.total)
View(medias.total)
medias.total$Renta
medias.total$Renta_Mixta
#Mostramos un gráfico XY con la población por
plot(medias.total$Poblacion1,medias.total$Renta_Mixta,  main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
View(medias.total)
View(medias.total)
View(medias.total)
View(medias.total)
#Mostramos un gráfico XY con la población por
plot(medias.total$porcentajePoblacion,medias.total$Renta_Mixta,  main= " Renta Mixta por Población en Euskadi", ylab="% Renta Mixta", xlab="% Población", col="Red")
View(medias.total)
View(medias.total)
data.km$centers
dist(data.km$centers)
View(medias.total)
View(medias.total)
dist(mwedias.total)
dist(medias.total)
dist(scale(medias.total))
